),
scalePar = "price",
numMultiStarts = 50,
numCores = 1
)
View(data_dce)
# ----Data----
## ----Load dataset----
data_dce <- read_csv(here(
"data",
"main",
"vehicle_choice_data.csv"
))
View(data_covariate)
View(data_dce)
data_variable <- read_csv(here(
"data",
"main",
"data_clean_variables.csv"
))
data_variable <- data_variable %>%
select(
psid,
ends_with("_num"),
ends_with("_cate"),
starts_with("ATT_"),
starts_with("FA_"),
starts_with("knowledge_"),
Veh_hh_fuel,
starts_with("EV_")
)
# glimpse(data)
## ----Processing----
data_dce <- data_dce %>%
mutate(
price = price / 10000, # 0.4-6
range_bev = range_bev / 100, # 0.5 - 2.5
range_phev = range_phev / 10, # 1 - 4
mileage = mileage * 10, # 2 - 6
age = age * 10, # 2 - 8
operating_cost = operating_cost # 3 - 18,
) %>%
select(-range, -operating_cost_text, -session_id, -vehicle_type)
View(data_dce)
data_covariate <- data_dce %>%
left_join(data_variable, by = "psid")
View(data_covariate)
data_dce <- cbc_encode(
data_dce,
coding = 'dummy',
ref_levels = list(powertrain = 'gas')
) %>%
as.data.frame()
data_covariate <- cbc_encode(
data_covariate %>%
select(!psid) %>%
mutate(
knowledge_gas = as.character(knowledge_gas),
knowledge_plugin = as.character(knowledge_plugin),
knowledge_ev = as.character(knowledge_ev),
knowledge_subsidy = as.character(knowledge_subsidy)
),
coding = 'dummy',
# categorical_attrs =
#   c(
#   "Veh_hh_fuel",
#   "gender_cate",
#   "ethnicity_cate"
#   # names(select(
#   #   data_covariate,
#   #   ends_with("_cate"),
#   #   starts_with("ATT_"),
#   #   starts_with("knowledge_"),
#   #   starts_with("EV_")
#   # ))
# )),
ref_levels = list(
gender_cate = 'female',
ethnicity_cate = 'hispanic',
race_cate = 'white_only',
education_cate = 'high_school',
student_cate = 'student',
employment_cate = 'full_time',
hhtenure_cate = 'own',
hhtype_cate = 'sf_detached',
ATT_EVB_environment = 'neutral',
ATT_EVB_function = 'neutral',
ATT_techsavvy = 'neutral',
ATT_risktaker = 'neutral',
ATT_climate = 'a_little',
ATT_political = 'conservative',
ATT_voting = 'democratic',
Veh_hh_fuel = 'icev_only',
EV_charger = 'no',
EV_neighbor = 'no',
knowledge_gas = '0',
knowledge_plugin = '0',
knowledge_ev = '0',
knowledge_subsidy = '0'
)
) %>%
as.data.frame()
View(data_covariate)
View(data_covariate)
# ----Data----
## ----Load dataset----
data_dce <- read_csv(here(
"data",
"main",
"vehicle_choice_data.csv"
))
data_variable <- read_csv(here(
"data",
"main",
"data_clean_variables.csv"
))
data_variable <- data_variable %>%
select(
psid,
ends_with("_num"),
ends_with("_cate"),
starts_with("ATT_"),
starts_with("FA_"),
starts_with("knowledge_"),
Veh_hh_fuel,
starts_with("EV_")
)
View(data_dce)
# glimpse(data)
## ----Processing----
data_dce <- data_dce %>%
mutate(
price = price / 10000, # 0.4-6
range_bev = range_bev / 100, # 0.5 - 2.5
range_phev = range_phev / 10, # 1 - 4
mileage = mileage * 10, # 2 - 6
age = age * 10, # 2 - 8
operating_cost = operating_cost # 3 - 18,
) %>%
select(-range, -operating_cost_text, -session_id, -vehicle_type)
data_covariate <- data_dce %>%
left_join(data_variable, by = "psid")
data_dce <- cbc_encode(
data_dce%>%
select(!psid),
coding = 'dummy',
ref_levels = list(powertrain = 'gas')
) %>%
as.data.frame()
View(data_dce)
data_covariate <- cbc_encode(
data_covariate %>%
select(!psid) %>%
mutate(
knowledge_gas = as.character(knowledge_gas),
knowledge_plugin = as.character(knowledge_plugin),
knowledge_ev = as.character(knowledge_ev),
knowledge_subsidy = as.character(knowledge_subsidy)
),
coding = 'dummy',
# categorical_attrs =
#   c(
#   "Veh_hh_fuel",
#   "gender_cate",
#   "ethnicity_cate"
#   # names(select(
#   #   data_covariate,
#   #   ends_with("_cate"),
#   #   starts_with("ATT_"),
#   #   starts_with("knowledge_"),
#   #   starts_with("EV_")
#   # ))
# )),
ref_levels = list(
gender_cate = 'female',
ethnicity_cate = 'hispanic',
race_cate = 'white_only',
education_cate = 'high_school',
student_cate = 'student',
employment_cate = 'full_time',
hhtenure_cate = 'own',
hhtype_cate = 'sf_detached',
ATT_EVB_environment = 'neutral',
ATT_EVB_function = 'neutral',
ATT_techsavvy = 'neutral',
ATT_risktaker = 'neutral',
ATT_climate = 'a_little',
ATT_political = 'conservative',
ATT_voting = 'democratic',
Veh_hh_fuel = 'icev_only',
EV_charger = 'no',
EV_neighbor = 'no',
knowledge_gas = '0',
knowledge_plugin = '0',
knowledge_ev = '0',
knowledge_subsidy = '0'
)
) %>%
as.data.frame()
# ---- ****DCE ONLY + Covariates**** ----
## --- WTP Space ----
mnl_wtp_knowledge <- logitr(
data = data_covariate,
outcome = "choice",
obsID = "obsID",
pars = c(
"mileage",
"age",
"operating_cost",
"range_bev",
"range_phev",
"powertrainbev",
"powertrainphev",
"powertrainhev",
"no_choice",
"knowledge_gas1",
"knowledge_gas2",
"knowledge_plugin1",
"knowledge_plugin2",
"knowledge_ev1",
"knowledge_subsidy1"
),
scalePar = "price",
numMultiStarts = 50,
numCores = 1
)
View(data_covariate)
data_dce <- read_csv(here(
"data",
"main",
"vehicle_choice_data.csv"
))
data_variable <- read_csv(here(
"data",
"main",
"data_clean_variables.csv"
))
data_variable <- data_variable %>%
select(
psid,
ends_with("_num"),
ends_with("_cate"),
starts_with("ATT_"),
starts_with("FA_"),
starts_with("knowledge_"),
Veh_hh_fuel,
starts_with("EV_")
)
# head(data)
# glimpse(data)
## ----Processing----
data_dce <- data_dce %>%
mutate(
price = price / 10000, # 0.4-6
range_bev = range_bev / 100, # 0.5 - 2.5
range_phev = range_phev / 10, # 1 - 4
mileage = mileage * 10, # 2 - 6
age = age * 10, # 2 - 8
operating_cost = operating_cost # 3 - 18,
) %>%
select(-range, -operating_cost_text, -session_id, -vehicle_type)
## ----Dummy encode----
data_dce <- cbc_encode(
data_dce %>%
select(!psid),
coding = 'dummy',
ref_levels = list(powertrain = 'gas')
) %>%
as.data.frame()
data_covariate <- data_dce %>%
left_join(data_variable, by = "psid")
data_dce_dummy <- cbc_encode(
data_dce %>%
select(!psid),
coding = 'dummy',
ref_levels = list(powertrain = 'gas')
) %>%
as.data.frame()
# ----Data----
## ----Load dataset----
data_dce <- read_csv(here(
"data",
"main",
"vehicle_choice_data.csv"
))
# glimpse(data)
## ----Processing----
data_dce <- data_dce %>%
mutate(
price = price / 10000, # 0.4-6
range_bev = range_bev / 100, # 0.5 - 2.5
range_phev = range_phev / 10, # 1 - 4
mileage = mileage * 10, # 2 - 6
age = age * 10, # 2 - 8
operating_cost = operating_cost # 3 - 18,
) %>%
select(-range, -operating_cost_text, -session_id, -vehicle_type)
data_dce_dummy <- cbc_encode(
data_dce %>%
select(!psid),
coding = 'dummy',
ref_levels = list(powertrain = 'gas')
) %>%
as.data.frame()
data_dce_dummy<-cbind(data_dce_dummy,data_dce$psid)
View(data_dce_dummy)
data_dce_dummy<-cbind(data_dce_dummy,data_dce %>% select(psid))
data_dce_dummy <- cbc_encode(
data_dce %>%
select(!psid),
coding = 'dummy',
ref_levels = list(powertrain = 'gas')
) %>%
as.data.frame()
data_dce_dummy<-cbind(data_dce_dummy,data_dce %>% select(psid))
View(data_dce_dummy)
data_covariate <- data_dce_dummy %>%
left_join(data_variable, by = "psid")
View(data_covariate)
# ---- ****DCE ONLY + Covariates**** ----
## --- WTP Space ----
mnl_wtp_knowledge <- logitr(
data = data_covariate,
outcome = "choice",
obsID = "obsID",
pars = c(
"mileage",
"age",
"operating_cost",
"range_bev",
"range_phev",
"powertrainbev",
"powertrainphev",
"powertrainhev",
"no_choice",
"knowledge_gas1",
"knowledge_gas2",
"knowledge_plugin1",
"knowledge_plugin2",
"knowledge_ev1",
"knowledge_subsidy1"
),
scalePar = "price",
numMultiStarts = 50,
numCores = 1
)
data_covariate <- cbc_encode(
data_covariate %>%
select(!psid) %>%
mutate(
knowledge_gas = as.character(knowledge_gas),
knowledge_plugin = as.character(knowledge_plugin),
knowledge_ev = as.character(knowledge_ev),
knowledge_subsidy = as.character(knowledge_subsidy)
),
coding = 'dummy',
# categorical_attrs =
#   c(
#   "Veh_hh_fuel",
#   "gender_cate",
#   "ethnicity_cate"
#   # names(select(
#   #   data_covariate,
#   #   ends_with("_cate"),
#   #   starts_with("ATT_"),
#   #   starts_with("knowledge_"),
#   #   starts_with("EV_")
#   # ))
# )),
ref_levels = list(
gender_cate = 'female',
ethnicity_cate = 'hispanic',
race_cate = 'white_only',
education_cate = 'high_school',
student_cate = 'student',
employment_cate = 'full_time',
hhtenure_cate = 'own',
hhtype_cate = 'sf_detached',
ATT_EVB_environment = 'neutral',
ATT_EVB_function = 'neutral',
ATT_techsavvy = 'neutral',
ATT_risktaker = 'neutral',
ATT_climate = 'a_little',
ATT_political = 'conservative',
ATT_voting = 'democratic',
Veh_hh_fuel = 'icev_only',
EV_charger = 'no',
EV_neighbor = 'no',
knowledge_gas = '0',
knowledge_plugin = '0',
knowledge_ev = '0',
knowledge_subsidy = '0'
)
) %>%
as.data.frame()
# ---- ****DCE ONLY + Covariates**** ----
## --- WTP Space ----
mnl_wtp_knowledge <- logitr(
data = data_covariate,
outcome = "choice",
obsID = "obsID",
pars = c(
"mileage",
"age",
"operating_cost",
"range_bev",
"range_phev",
"powertrainbev",
"powertrainphev",
"powertrainhev",
"no_choice",
"knowledge_gas1",
"knowledge_gas2",
"knowledge_plugin1",
"knowledge_plugin2",
"knowledge_ev1",
"knowledge_subsidy1"
),
scalePar = "price",
numMultiStarts = 50,
numCores = 1
)
# View summary of results
summary(mnl_wtp_knowledge)
# ---- ****DCE ONLY + Covariates**** ----
## --- WTP Space ----
mnl_wtp_knowledge <- logitr(
data = data_covariate,
outcome = "choice",
obsID = "obsID",
pars = c(
"mileage",
"age",
"operating_cost",
"range_bev",
"range_phev",
"powertrainbev",
"powertrainphev",
"powertrainhev",
"no_choice"
# "knowledge_gas1",
# "knowledge_gas2"
# "knowledge_plugin1",
# "knowledge_plugin2",
# "knowledge_ev1",
# "knowledge_subsidy1"
),
scalePar = "price",
numMultiStarts = 50,
numCores = 1
)
# View summary of results
summary(mnl_wtp_knowledge)
# ---- ****DCE ONLY + Covariates**** ----
## --- WTP Space ----
mnl_wtp_knowledge <- logitr(
data = data_covariate,
outcome = "choice",
obsID = "obsID",
pars = c(
"mileage",
"age",
"operating_cost",
"range_bev",
"range_phev",
"powertrainbev",
"powertrainphev",
"powertrainhev",
"no_choice",
"knowledge_gas1",
"knowledge_gas2"
# "knowledge_plugin1",
# "knowledge_plugin2",
# "knowledge_ev1",
# "knowledge_subsidy1"
),
scalePar = "price",
numMultiStarts = 50,
numCores = 1
)
# View summary of results
summary(mnl_wtp_knowledge)
# ---- ****DCE ONLY + Covariates**** ----
## --- WTP Space ----
mnl_wtp_knowledge <- logitr(
data = data_covariate,
outcome = "choice",
obsID = "obsID",
pars = c(
"mileage",
"age",
"operating_cost",
"range_bev",
"range_phev",
"powertrainbev",
"powertrainphev",
"powertrainhev",
"no_choice",
"FA_EV_benefit"
# "knowledge_gas1",
# "knowledge_gas2"
# "knowledge_plugin1",
# "knowledge_plugin2",
# "knowledge_ev1",
# "knowledge_subsidy1"
),
scalePar = "price",
numMultiStarts = 50,
numCores = 1
)
# View summary of results
summary(mnl_wtp_knowledge)
